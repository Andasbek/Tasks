### Задача: Преобразование из camelCase в snake_case

Напишите функцию на Python, которая преобразует строку из формата `camelCase` в формат `snake_case`.

- Если строка пустая, функция должна вернуть пустую строку.
- Если строка не соответствует правилам `camelCase`, функция должна вернуть её без изменений.
- Если строка соответствует `camelCase`, функция должна вернуть её преобразованный вариант в формате `snake_case`.

### Правила `camelCase`:
1. Допускаются два варианта записи: `lowerCamelCase` и `UpperCamelCase`.
2. Слово не должно заканчиваться заглавной буквой (например, `CamelCasE` недопустимо).
3. Никакие две заглавные буквы не должны идти подряд (например, `CamelCAse` недопустимо).
4. В слове не должны присутствовать числа или знаки препинания (например, `camelCase1` недопустимо).

### Требования:
1. Запрещено использовать встроенные функции для изменения регистра, такие как `str.lower()`, `str.upper()`, а также функции для поиска шаблонов.
2. Реализуйте алгоритм преобразования вручную, используя циклы и условия для обработки символов.

### Ожидаемая функция:
```python
def camel_to_snake_case(s):
    # Реализация функции
```

### Примеры использования:
```python
print(camel_to_snake_case("HelloWorld"))      # Ожидаемый результат: Hello_World
print(camel_to_snake_case("helloWorld"))      # Ожидаемый результат: hello_World
print(camel_to_snake_case("camelCase"))       # Ожидаемый результат: camel_Case
print(camel_to_snake_case("CAMELtoSnackCASE"))# Ожидаемый результат: CAMELtoSnackCASE
print(camel_to_snake_case("camelToSnakeCase"))# Ожидаемый результат: camel_To_Snake_Case
print(camel_to_snake_case("hey2"))            # Ожидаемый результат: hey2
```

### Подсказка:
Пусть студенты реализуют алгоритм, проходя по символам строки и вставляя символ `_` перед заглавными буквами, если они находятся не в начале строки. Необходимо учитывать правила для допустимых форматов `camelCase`.